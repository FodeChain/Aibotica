<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>BotCrafter</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* æ•´ä½“èƒŒæ™¯å’Œå¸ƒå±€ */
    body, html {
      height: 100%;
      margin: 0;
      background: #f0f2f5;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      overflow: hidden; /* é˜²æ­¢åŒæ»šåŠ¨æ¡ */
    }
    #container {
      display: flex;
      height: 100vh;
      width: 100vw;
    }
    /* å·¦ä¾§èŠå¤©åŒºåŸŸ */
    #chat-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #ddd;
      background: #fff;
      padding: 16px;
    }
    #chat {
      flex: 1;
      overflow-y: auto;
      padding-right: 10px;
      background: #fafafa;
      border-radius: 8px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    }
    /* æ°”æ³¡æ ·å¼ */
    .chat-message {
      width: 100%;
      max-width: 100%;
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 20px;
      word-wrap: break-word;
      line-height: 1.4;
      font-size: 15px;
      position: relative;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    //.chat-user {
     // background: #d0e6ff;
    //  align-self: stretch;
    //  border-bottom-right-radius: 4px;
    //  text-align: left;
   // }
   // .chat-ai {
   //   background: #ececec;
  //    align-self: stretch;
   //   border-bottom-left-radius: 4px;
   //   text-align: left; 
   // }
   .chat-user { background: #d0e6ff; }
    .chat-ai { background: #ececec; }
    #input-area {
      margin-top: 12px;
      display: flex;
      gap: 8px;
    }
    
    /* è¾“å…¥æ¡†åŒºåŸŸ */
    #input-area {
      margin-top: 12px;
      display: flex;
      gap: 8px;
    }
    #message-input {
      flex: 1;
      font-size: 16px;
      padding: 10px 14px;
      border-radius: 20px;
      border: 1px solid #ccc;
      outline: none;
      transition: border-color 0.3s;
    }
    #message-input:focus {
      border-color: #3a8ee6;
      box-shadow: 0 0 5px rgba(58,142,230,0.5);
    }
    #send-btn {
      background-color: #3a8ee6;
      border: none;
      color: white;
      padding: 0 20px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
    }
    #send-btn:hover {
      background-color: #337acc;
    }

    /* å³ä¾§å›¾ç‰‡å’Œä»£ç åŒºåŸŸ */
    #right-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #fff;
      padding: 16px;
    }
    #image-container {
      position: relative;
      flex: 1;
      border-radius: 8px;
      background: #fafafa;
      box-shadow: inset 0 0 8px rgba(0,0,0,0.05);
      padding: 16px;
      display: flex;
      flex-direction: column;
    }
    #version-title {
      font-weight: 700;
      color: #555;
      margin-bottom: 12px;
      font-size: 16px;
    }
    #generated-image {
      flex: 1;
      object-fit: contain;
      border-radius: 8px;
      background: white;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      margin-bottom: 12px;
      max-height: 70vh;
      width: 100%;
    }
   #code-display {
      display: none;
      white-space: pre-wrap;
      background: #f8f9fa;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-family: Consolas, "Courier New", monospace;
      font-size: 14px;
      overflow-y: auto;
      max-height: 650px;
      flex: none;
    }
    

    /* å³ä¸ŠæŒ‰é’®ç»„ */
    #btn-group {
      position: absolute;
      top: 16px;
      right: 16px;
      display: flex;
      gap: 10px;
      z-index: 10;
    }
    #btn-group button {
      padding: 6px 10px;
      font-size: 13px;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      box-shadow: 0 1px 4px rgba(0,0,0,0.15);
      transition: background-color 0.3s;
    }
    #prev-btn {
      background-color: #f0ad4e;
      color: white;
    }
    #prev-btn:hover {
      background-color: #ec971f;
    }
    #next-btn {
      background-color: #5bc0de;
      color: white;
    }
    #next-btn:hover {
      background-color: #31b0d5;
    }
    #toggle-btn {
      background-color: #6c757d;
      color: white;
    }
    #toggle-btn:hover {
      background-color: #5a6268;
    }
    #open-3d-btn {
      position: absolute;
      bottom: 16px;
      right: 16px;
      background-color: #5cb85c;
      color: white;
      padding: 8px 14px;
      border-radius: 20px;
      border: none;
      cursor: pointer;
      box-shadow: 0 1px 5px rgba(0,0,0,0.2);
      transition: background-color 0.3s;
    }
    #open-3d-btn:hover {
      background-color: #449d44;
    }

    /* loaderç‚¹åŠ¨ç”»ä¿æŒ */
    .loader-dots {
      display: inline-flex;
      align-items: center;
      font-size: 18px;
    }
    .loader-dot {
      margin: 0 2px;
      opacity: 0.3;
      animation: blink 1s infinite;
    }
    .loader-dot:nth-child(1) { animation-delay: 0s; }
    .loader-dot:nth-child(2) { animation-delay: 0.2s; }
    .loader-dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes blink {
      0%, 80%, 100% { opacity: 0.3; }
      40% { opacity: 1; }
    }

  </style>
</head>
<body>
  <div id="container">
    <section id="chat-section">
      <div id="chat"></div>
      <div id="input-area">
        <input type="text" id="message-input" placeholder="è¾“å…¥æ‚¨éœ€è¦å­¦ä¹ çš„å†…å®¹..." autocomplete="off" />
        <button id="send-btn">å‘é€</button>
      </div>
    </section>
    <section id="right-section">
      <div id="image-container">
        <div id="version-title">æš‚æ— å­¦ä¹ è®°å½•</div>
        <div id="btn-group">
          <button id="prev-btn">ä¸Šä¸€ä¸ªä¸»é¢˜</button>
          <button id="next-btn">ä¸‹ä¸€ä¸ªä¸»é¢˜</button>
          <button id="toggle-btn">æŸ¥çœ‹ä»£ç </button>
        </div>
        <img id="generated-image" src="" alt="æš‚æ— ç”Ÿæˆå›¾çº¸" />
        <div id="code-display"></div>
        <button id="open-3d-btn">åœ¨OpenSCADä¸­å­¦ä¹ </button>
      </div>
    </section>
  </div>

<script>
const sendBtn = document.getElementById('send-btn');
const input = document.getElementById('message-input');
const chat = document.getElementById('chat');
const image = document.getElementById('generated-image');
const codeDisplay = document.getElementById('code-display');
const toggleBtn = document.getElementById('toggle-btn');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const versionTitle = document.getElementById('version-title');
const open3dBtn = document.getElementById('open-3d-btn');

let history = [];
let currentIndex = -1;

// åŠ è½½å†å²
window.addEventListener('load', () => {
  fetch('/get_history')
  .then(response => response.json())
  .then(data => {
    if (data && data.length > 0) {
      let lastUserInput = "";
      for (let i = 0; i < data.length; i++) {
        const item = data[i];
        if (item.role === 'user') {
          lastUserInput = item.content;
          const userDiv = document.createElement('div');
          userDiv.className = "chat-message chat-user";
          userDiv.innerHTML = `<strong>æˆ‘ï¼š</strong>${item.content}`;
          chat.appendChild(userDiv);
        } else if (item.role === 'assistant') {
          const content = JSON.parse(item.content);
          const aiDiv = document.createElement('div');
          aiDiv.className = "chat-message chat-ai";
          const formatted = content.text.replace(/\n/g, "<br>");
          aiDiv.innerHTML = `<strong>BotCrafterï¼š</strong>${formatted}`;
          chat.appendChild(aiDiv);
          history.push({
            input: lastUserInput,
            reply: content.text,
            image_url: content.image_url,
            code: content.code
          });
        }
      }
      currentIndex = history.length - 1;
      showCurrent();
      setTimeout(() => {
        chat.scrollTop = chat.scrollHeight;
      }, 100);
    }
  });
});

sendBtn.addEventListener('click', () => {
  const message = input.value.trim();
  if (!message) return;
  
  input.value = '';

  // ç”¨æˆ·æ¶ˆæ¯
  const userDiv = document.createElement('div');
  userDiv.className = "chat-message chat-user";
  userDiv.innerHTML = `<strong>æˆ‘ï¼š</strong>${message}`;
  chat.appendChild(userDiv);
  chat.scrollTop = chat.scrollHeight;

  // AIæ­£åœ¨æ€è€ƒ
  const thinkingDiv = document.createElement('div');
  thinkingDiv.className = "chat-message chat-ai";
  thinkingDiv.innerHTML = `
    <strong>BotCrafterï¼š</strong>
    <span class="loader-dots">
      <span class="loader-dot">â—</span>
      <span class="loader-dot">â—</span>
      <span class="loader-dot">â—</span>
    </span>
    <br>
    <span class="waiting-time">æ­£åœ¨ä¸ºæ‚¨è®¾è®¡ï¼Œé¢„è®¡ç­‰å¾…2åˆ†é’Ÿï¼Œå·²ç­‰å¾…0s</span>
    <br>
    <span class="tips-text"></span>
  `;
  chat.appendChild(thinkingDiv);
  chat.scrollTop = chat.scrollHeight;

  const waitingTimeSpan = thinkingDiv.querySelector('.waiting-time');
  const tipsSpan = thinkingDiv.querySelector('.tips-text');

  const tips = [
   "è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººçš„è¿åŠ¨å­¦ä¸åŠ¨åŠ›å­¦å»ºæ¨¡æ˜¯ç»“æ„è®¾è®¡çš„åŸºç¡€ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººçš„å…³èŠ‚ç±»å‹ä¸»è¦åŒ…æ‹¬æ—‹è½¬å…³èŠ‚å’Œç§»åŠ¨å…³èŠ‚ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æ¨¡å—åŒ–æœºå™¨äººè®¾è®¡èƒ½æé«˜çµæ´»æ€§ä¸é€‚åº”æ€§ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººæœ«ç«¯æ‰§è¡Œå™¨çš„é€‰æ‹©è¦æ ¹æ®ä»»åŠ¡ç‰¹æ€§å†³å®šã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å·®é€Ÿé©±åŠ¨å¸¸ç”¨äºä¸¤è½®ç§»åŠ¨æœºå™¨äººã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å¤šè‡ªç”±åº¦æœºæ¢°è‡‚éœ€è¦æ±‚è§£é€†è¿åŠ¨å­¦ä»¥ç¡®å®šå…³èŠ‚è§’åº¦ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å¸¸è§çš„æœºå™¨äººææ–™åŒ…æ‹¬é“åˆé‡‘ã€ç¢³çº¤ç»´å’Œå·¥ç¨‹å¡‘æ–™ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– ä¼ºæœç”µæœºä¸æ­¥è¿›ç”µæœºæ˜¯æœºå™¨äººå…³èŠ‚å¸¸ç”¨çš„é©±åŠ¨æ–¹å¼ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– è¿åŠ¨è§„åˆ’ç®—æ³•å¦‚A*å’ŒRRTç”¨äºè·¯å¾„ç”Ÿæˆã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººæ§åˆ¶åˆ†ä¸ºå¼€ç¯æ§åˆ¶å’Œé—­ç¯æ§åˆ¶ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– SLAMæŠ€æœ¯è®©ç§»åŠ¨æœºå™¨äººå®ç°è‡ªä¸»å®šä½ä¸åœ°å›¾æ„å»ºã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æŸ”æ€§é©±åŠ¨å¯ä»¥æå‡æœºå™¨äººåœ¨å¤æ‚ç¯å¢ƒä¸‹çš„é€‚åº”èƒ½åŠ›ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººæ„ŸçŸ¥ç³»ç»ŸåŒ…æ‹¬æ¿€å…‰é›·è¾¾ã€æ‘„åƒå¤´å’Œè¶…å£°æ³¢ä¼ æ„Ÿå™¨ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å†—ä½™æœºæ¢°è‡‚å¯é€šè¿‡ä¼˜åŒ–æé«˜ä½œä¸šç¨³å®šæ€§ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æ™ºèƒ½ç®—æ³•å¯ä»¥æ ¹æ®ä»»åŠ¡åŠ¨æ€è°ƒæ•´ç»“æ„å‚æ•°ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– ä»¿ç”Ÿæœºå™¨äººé€šè¿‡æ¨¡ä»¿è‡ªç„¶ç•Œç”Ÿç‰©å®ç°å¤æ‚è¿åŠ¨ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å…­è¶³æœºå™¨äººå…·æœ‰è‰¯å¥½çš„è¶Šéšœèƒ½åŠ›å’Œç¨³å®šæ€§ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å››è¶³æœºå™¨äººåœ¨åŠ¨æ€æ­¥æ€è§„åˆ’ä¸­éœ€è€ƒè™‘è¶³ç«¯æ¥è§¦åŠ›ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨äººçš„é—­ç¯æ§åˆ¶ä¾èµ–ä¼ æ„Ÿå™¨åé¦ˆç²¾ç¡®ä¿®æ­£åŠ¨ä½œã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å¿«é€ŸåŸå‹å¼€å‘å¯ä»¥æ˜¾è‘—ç¼©çŸ­æœºå™¨äººè®¾è®¡å‘¨æœŸã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– ä»¿çœŸå¹³å°å¦‚Gazeboå’ŒWebotså¸¸ç”¨äºéªŒè¯æ§åˆ¶ç®—æ³•ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– æœºå™¨è§†è§‰ç”¨äºè¯†åˆ«ã€å®šä½å’Œè·Ÿè¸ªç›®æ ‡ç‰©ä½“ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– å¤šæœºå™¨äººåä½œç³»ç»Ÿå¯æå‡ä½œä¸šæ•ˆç‡å’Œç³»ç»Ÿé²æ£’æ€§ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– åŸºäºæ·±åº¦å­¦ä¹ çš„æ„ŸçŸ¥ç³»ç»Ÿèƒ½å®ç°æ›´å¼ºçš„ç¯å¢ƒç†è§£èƒ½åŠ›ã€‚",

"è®©æˆ‘ä»¬åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å·©å›ºçŸ¥è¯†ï¼š\n ğŸ¤– åŠ¨åŠ›å­¦å»ºæ¨¡éœ€è€ƒè™‘æ‘©æ“¦ã€æƒ¯æ€§å’Œå…³èŠ‚å¼¹æ€§ç­‰å› ç´ ã€‚",


  ];
  let tipIndex = 0;

  // å¼€å§‹æ›´æ–°å·²ç­‰å¾…æ—¶é—´
  let seconds = 0;
  const timer = setInterval(() => {
    seconds++;
    waitingTimeSpan.textContent = `æ­£åœ¨ä¸ºæ‚¨è®¾è®¡ï¼Œé¢„è®¡ç­‰å¾…2åˆ†é’Ÿï¼Œå·²ç­‰å¾…${seconds}s`;
    chat.scrollTop = chat.scrollHeight;
  }, 1000);

// æ¯4ç§’æ›´æ–°æç¤º
tipsSpan.innerHTML = tips[tipIndex].replace(/\n/g, "<br>");
const tipsTimer = setInterval(() => {
  tipIndex = (tipIndex + 1) % tips.length;
  tipsSpan.innerHTML = tips[tipIndex].replace(/\n/g, "<br>");
  chat.scrollTop = chat.scrollHeight;
}, 4000);

  fetch('/chat', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({message: message})
  })
  .then(response => response.json())
  .then(data => {
    clearInterval(timer);
    clearInterval(tipsTimer);
    thinkingDiv.remove();

    // AIå›å¤
    const aiDiv = document.createElement('div');
    aiDiv.className = "chat-message chat-ai";
    aiDiv.innerHTML = `<strong>BotCrafterï¼š</strong><span></span>`;
    const typingSpan = aiDiv.querySelector('span');
    chat.appendChild(aiDiv);
    chat.scrollTop = chat.scrollHeight;

    // æ‰“å­—æ•ˆæœ
    let i = 0;
    let buffer = "";
    function typeWriter() {
      if (i < data.reply.length) {
        const char = data.reply.charAt(i);
        if (char === "\n") {
          buffer += "<br>";
        } else {
          buffer += char;
        }
        typingSpan.innerHTML = buffer;
        i++;
        setTimeout(typeWriter, 5);
        chat.scrollTop = chat.scrollHeight;
      }
    }
    typeWriter();

    history.push({
      input: message,
      reply: data.reply,
      image_url: data.image_url,
      code: data.code
    });
    currentIndex = history.length - 1;
    showCurrent();

    input.value = '';
  });
});

// ç›‘å¬è¾“å…¥æ¡†æŒ‰é”®
input.addEventListener('keydown', (event) => {
  if (event.key === 'Enter') {
    sendBtn.click();
  }
});

toggleBtn.addEventListener('click', () => {
  if (image.style.display !== "none") {
    image.style.display = "none";
    codeDisplay.style.display = "block";
    toggleBtn.textContent = "æŸ¥çœ‹å›¾çº¸";
    // åˆ‡æ¢åˆ°ä»£ç ï¼Œæ»šåŠ¨åˆ°é¡¶éƒ¨
    codeDisplay.scrollTop = 0;
  } else {
    image.style.display = "block";
    codeDisplay.style.display = "none";
    toggleBtn.textContent = "æŸ¥çœ‹ä»£ç ";
  }
});


prevBtn.addEventListener('click', () => {
  if (currentIndex > 0) {
    currentIndex--;
    showCurrent();
  } else {
    alert("å·²ç»æ˜¯æœ€æ—©çš„è®°å½•ï¼");
  }
});

nextBtn.addEventListener('click', () => {
  if (currentIndex < history.length - 1) {
    currentIndex++;
    showCurrent();
  } else {
    alert("å·²ç»æ˜¯æœ€æ–°çš„è®°å½•ï¼");
  }
});

function showCurrent() {
  if (currentIndex >= 0 && currentIndex < history.length) {
    const item = history[currentIndex];
    versionTitle.textContent = `å­¦ä¹ ä¸»é¢˜: ${item.input}...`;
    image.src = item.image_url;
    codeDisplay.textContent = item.code;
    image.style.display = "block";
    codeDisplay.style.display = "none";
    toggleBtn.textContent = "æŸ¥çœ‹ä»£ç ";
    
    // æ¯æ¬¡åˆ‡æ¢ç‰ˆæœ¬æ—¶ï¼Œä»£ç åŒºæ»šåŠ¨é‡ç½®
    codeDisplay.scrollTop = 0;
  } else {
    versionTitle.textContent = "æš‚æ— å­¦ä¹ è®°å½•";
  }
}


open3dBtn.addEventListener('click', () => {
  if (currentIndex >= 0 && currentIndex < history.length) {
    const item = history[currentIndex];
    fetch('/open3d', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ code: item.code })
    })
    .then(response => response.json())
    .then(data => {
      alert(data.message);
    })
    .catch(err => {
      alert("è¯·æ±‚å‡ºé”™ï¼š" + err);
    });
  } else {
    alert("æ²¡æœ‰å¯ç”¨çš„ä»£ç ï¼");
  }
});
</script>

</body>
</html>
